<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <script>
    Promise.myAllSettled =function(promise){
        return new Promise((resolve,reject)=>{
            if(!(promise instanceof Array)){
                throw new TypeError('promise must be an array')
            }
            else {
                const res= []
                let count=0
                promise.forEach((item,index)=>{
                    item.then((val)=>{
                        res[index] = {status:'fulfilled',value:val}
                    }).catch((err)=>{
                        res[index] = {status:'rejected',reason:err}
                    }).finally(()=>{
                        count++
                        if(count===promise.length){
                            resolve(res)
                        }
                    })
                })
            }
        })
    }
    const p1 = Promise.myAllSettled([
        Promise.resolve(1),
        Promise.resolve(2),
        Promise.reject('error'),
    ])
        p1.then((val)=>{
            console.log(val)
        })
  </script>
</body>
